#! /usr/bin/env python
# -*- coding: utf-8 -*-


from MetaParser import *


def ML_ISAEV_parse(fileOpenXML):
    """
    HARDCORE
    """
    subject = u"Математическая логика"
    workbook = openpyxl.load_workbook(filename=fileOpenXML)

    for sheet in workbook.worksheets:
        assert isinstance(sheet, openpyxl.worksheet.Worksheet)
        
        for row in sheet.rows[:]:
            surname, name = row[0].split()
            for task, score in enumerate(row[:8]):
                print score.style.fill.start_color.index
                student = StInfo(name, surname, subject, 1 + int(task), task, task, now)
                StInfoList.append(student)


if __name__ == "__main__":
#    StInfoList = []
#    folder = "OpenXML"
#    ext = "xlsx"#
#
    import datetime
    now = datetime.datetime.now()
#
#    ML_ISAEV_parse("{0}.{1}".format(os.path.join(folder, courses.spreadsheets['ML_ISAEV']), ext))
# 
#    for st in StInfoList: print st
